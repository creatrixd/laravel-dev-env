# Llcrm development environment
# Руководство к использованию

### Окружение создано с целью упрощения запуска и разработки приложения на локальном компьютере.

### Требования к развертыванию
- Docker
- Git
- Make (Желательно)

### Окружение использует следующий набор технологий:
- PHP 8.2 + fpm (Сервирование приложения в многопоточном режиме)
- Nginx (Обеспечение FastCGI проксирования)
- Supervisor (Поддержка одновременной работы PHP-fpm и nginx)
- Sqlite (Хранилище данных приложения)
- Laravel (Основной backend фреймворк)
- Node (Среда для сборки frondend)
- Nano (Консольный текстовый редактор)
- fish (Командная оболочка для более удобной работы внутри контейнера)

Предполагается использование утилиты [make](https://ru.wikipedia.org/wiki/Make). В случае использования системы windows/работы через Docker Desktop все операции также можно выполнять и через графический интерфейс. С доступными командами можно ознакомиться в файле [Makefile](Makefile).

---
### Базовое использование:
Перед запуском окружения необходимо скопировать рабочий проект в папку test.llcrm.ru (имя можно изменить в Makefile параметре VOLUME).

Установка зависимостей подразумевается после запуска контейнера изнутри него.
```shell
make up         # Сборка образа, запуск контейнера на базе образа   
make connect    # Подключение к оболочке fish внутри контейнера
make drop       # Остановка контейнера, удаление контейнера, удаление образа
```
---

### Базовые принципы:
- Во избежания проблем со сборкой образа, запуском контейнера и работой приложения не рекомендуется изменение файлов Dockerfile, nginx.conf, supervisord.conf.
- Подразумевается возможность редактирования Makefile под свои потребности и добавления новых команд.
- Допускается замена утилиты make на любую другую, которая обеспечит быстрое управление окружением, или полный отказ от вспомогательных утилит и выполнение каждой команды вручную или через GUI приложения, например, через Docker Desktop.
- Из-за особенностей работы с томами (volumes) изнутри контейнера возникает проблема невозможности изменения файлов. Для этого добавлена команда **make permit**, которая переписывает права и разрешает любые действия в рабочей директории в контейнере.
---

### Переопределение параметров
При использовании make можно переопределять параметры, содерщащиеся внутри Makefile, чтобы изменять поведение команд, с помощью следующего синтаксиса:
```shell
make build IMAGE_NAME=some_other_image_name
```
